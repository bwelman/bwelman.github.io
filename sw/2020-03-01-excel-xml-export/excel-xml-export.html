<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Welman">

<title>Ben Welman - Exceldata naar xml exporteren</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DZG4072LJ3"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DZG4072LJ3', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo-transparant.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../studieboeken.html">
 <span class="menu-text">Studieboeken</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../softwijs.html">
 <span class="menu-text">Softwijs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../vlearmoesbier.html">
 <span class="menu-text">Vlearmoesbier</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exceldata naar xml exporteren</h1>
  <div class="quarto-categories">
    <div class="quarto-category">excel</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur</div>
    <div class="quarto-title-meta-contents">
             <p>Ben Welman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Publicatiedatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">1 maart 2020</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Samenvatting</div>
    <p>Gegevens in een Excel tabel exporteren naar een XML bestand.</p>
  </div>
</div>

</header>

<p>Het is niet moeilijk om de gegevens in een Excel tabel naar een XML bestand om te zetten.</p>
<p>Download het bestand <a href="verkopen-data.xlsx">verkopen-data.xlsx</a> en open het vervolgens in Excel. In een Excel tabel staan de volgende gegevens:</p>
<div id="fig-xml-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="xml-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;1: Tabel met verkoopgegevens.</figcaption><p></p>
</figure>
</div>
<p>Om deze naar XML te exporteren moet er eerst een XML schema gemaakt worden dat gebaseerd is op deze gegevens. In plaats van een officieel schema of DTD te maken kun je ook een eenvoudig XML bestand maken met daarin de eerste twee records. Open een kladblok programma en plaats daarin het de volgende tekst.</p>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;verkopen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
    &lt;record&gt;
       &lt;Voornaam&gt;Roger&lt;/Voornaam&gt;
       &lt;Achternaam&gt;Rood&lt;/Achternaam&gt;
       &lt;Verkopen&gt;13873&lt;/Verkopen&gt;
       &lt;Land&gt;Nederland&lt;/Land&gt;
       &lt;Kwartaal&gt;KW 3&lt;/Kwartaal&gt;
    &lt;/record&gt;
    &lt;record&gt;
       &lt;Voornaam&gt;Berend&lt;/Voornaam&gt;
       &lt;Achternaam&gt;Blauw&lt;/Achternaam&gt;
       &lt;Verkopen&gt;12262&lt;/Verkopen&gt;
       &lt;Land&gt;Belgie&lt;/Land&gt;
       &lt;Kwartaal&gt;KW 4&lt;/Kwartaal&gt;
    &lt;/record&gt;
&lt;/verkopen&gt;</code></pre>
<p>Sla het bestand in dezelfde map als het Excel bestand op onder de naam <em>verkopen-schema.xml</em> en sluit het kladblok programma.</p>
<p>Ga nu terug naar het geopende Excelbestand. Kies <em>tab Ontwikkelaars &gt; Bron (groep XML)</em>. Het XML taak paneel wordt nu geopend.</p>
<div id="fig-xml-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="xml-2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;2: XML taak paneel.</figcaption><p></p>
</figure>
</div>
<p>Klik op <em>XML-toewijzingen</em> om een XML bestand toe te voegen. Een dialoogvenster wordt nu geopend. Klik hierin op <em>Toevoegen</em> en selecteer daarna <em>verkopen-schema.xml</em>.</p>
<p>Je krijgt nu een waarschuwing dat de opgegeven XML-bron niet naar een schema verwijst en dat Excel op basis van dit bestand een schema maakt. Klik op <em>OK</em>.</p>
<div id="fig-xml-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="xml-3.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;3: XML toewijzingen.</figcaption><p></p>
</figure>
</div>
<p>Klik op <em>OK</em>.</p>
<div id="fig-xml-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="xml-4.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;4: XML taak paneel met daarin de velden uit het XML schema.</figcaption><p></p>
</figure>
</div>
<p>Sleep nu een voor een de vijf elementen (Voornaam, Achternaam, Verkopen, Land, Kwartaal) uit de XML-boom naar de juiste kolom in het werkblad.</p>
<div id="fig-xml-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="xml-5.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;5: Alle velden uit het schema zijn nu aan een kolom gekoppeld.</figcaption><p></p>
</figure>
</div>
<p>Je kunt controleren of de toewijzing goed uitgevoerd is, door de elementen in de XML-bron een voor een aan te klikken. De bijbehorende kolom uit de tabel moet dan geselecteerd worden.</p>
<p>Kies <em>tab Ontwikkelaars &gt; Exporteren (groep XML)</em>. Bewaar het bestand onder de naam <em>verkopen-xml.xml</em>.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/bwelman\.github\.io\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 copyright 2022, Ben Welman
  </li>  
</ul>
    </div>   
  </div>
</footer>



</body></html>