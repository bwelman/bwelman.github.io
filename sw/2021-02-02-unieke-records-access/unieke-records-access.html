<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Welman">

<title>Ben Welman - Unieke waarden/records in Access Queries</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo-transparant.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../studieboeken.html">
 <span class="menu-text">Studieboeken</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../softwijs.html">
 <span class="menu-text">Softwijs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../vlearmoesbier.html">
 <span class="menu-text">Vlearmoesbier</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Op deze pagina</h2>
   
  <ul>
  <li><a href="#inleiding" id="toc-inleiding" class="nav-link active" data-scroll-target="#inleiding">Inleiding</a></li>
  <li><a href="#qry-klanten-standaard" id="toc-qry-klanten-standaard" class="nav-link" data-scroll-target="#qry-klanten-standaard">qry Klanten standaard</a></li>
  <li><a href="#qry-klanten-unieke-waarden" id="toc-qry-klanten-unieke-waarden" class="nav-link" data-scroll-target="#qry-klanten-unieke-waarden">qry Klanten unieke waarden</a></li>
  <li><a href="#qry-klanten-unieke-records" id="toc-qry-klanten-unieke-records" class="nav-link" data-scroll-target="#qry-klanten-unieke-records">qry Klanten unieke records</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/bwelman/bwelman.github.io/issues/new" class="toc-action">Een probleem melden</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Unieke waarden/records in Access Queries</h1>
  <div class="quarto-categories">
    <div class="quarto-category">databases</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur</div>
    <div class="quarto-title-meta-contents">
             <p>Ben Welman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Publicatiedatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2 februari 2021</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Samenvatting</div>
    <p>Uitleg over het verschil tussen deze twee query opties in MS Access.</p>
  </div>
</div>

</header>

<section id="inleiding" class="level1">
<h1>Inleiding</h1>
<p>In het eigenschappen venster van een query zijn twee opties, <em>Unieke Waarden</em> en <em>Unieke Records</em>. Standaard staat de waarde voor beiden op <em>Nee</em>. Deze leveren soms dezelfde waarden op, maar er zijn significante verschillen wanneer je een van beide op <em>Ja</em> zet. Verder kun je niet beide waarden op <em>Ja</em> zetten.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Opmerking
</div>
</div>
<div class="callout-body-container callout-body">
<p>Deze eigenschappen corresponderen met respectievelijk de SQL opdrachten</p>
<p><em>DISTINCT</em> en <em>DISTINCTROW</em>.</p>
</div>
</div>
<ul>
<li><p><strong>Standaard</strong>, wanneer beide eigenschappen dus <em>Nee</em> zijn, worden alle records getoond die aan de queryvoorwaarden voldoen.</p></li>
<li><p><strong>Unieke Waarden</strong> (DISTINCT in SQL) controleert alleen de uitvoervelden van de query en verwijdert daarna de dubbele rijen. Bij meerdere uitvoervelden moet de combinatie van alle uitvoervelden uniek zijn.</p></li>
<li><p><strong>Unieke Records</strong> (DISTINCTROW in SQL) daarentegen controleert alle velden in de tabel die wordt opgevraagd en verwijdert duplicaten. De getoonde records moeten uniek zijn op basis van alle velden in de onderliggende tabellen en niet alleen de velden in de query.</p></li>
</ul>
<p>Verdere uitleg via een voorbeeld met een eenvoudige database <code>Voorbeeld_Uniek.accdb</code>. Deze bevat twee tabellen:</p>
<div id="fig-tabellen" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-klanten" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="tabel-klanten.png" class="img-fluid figure-img" data-ref-parent="fig-tabellen"></p>
<p></p><figcaption class="figure-caption">(a) Tabel Klanten</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-orders" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="tabel-orders.png" class="img-fluid figure-img" data-ref-parent="fig-tabellen"></p>
<p></p><figcaption class="figure-caption">(b) Tabel Orders</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figuur&nbsp;1: Tabellen in de database</figcaption><p></p>
</figure>
</div>
<p>Tussen de tabellen is een een-op-veel relatie van Klanten.Klantnr &gt; Orders.Klantnr.</p>
<p>Zoals je ziet zijn er twee verschillende klanten met dezelfde naam voor Bedrijf. In de query’s hierna wordt steeds deze naam getoond voor de drie verschillende mogelijkheden.</p>
</section>
<section id="qry-klanten-standaard" class="level1">
<h1>qry Klanten standaard</h1>
<p><strong>Ontwerp</strong></p>
<p>Onder deze naam is een query gemaakt waar beide tabellen aan zijn toegevoegd. Het ontwerpvenster ziet er als volgt uit:</p>
<div id="fig-qry-standaard-ontwerp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-standaard-ontwerp.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;2: Standaard ontwerp query Klanten</figcaption><p></p>
</figure>
</div>
<div id="fig-qry-standaard-eigenschappen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-standaard-eigenschappen.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;3: Standaard eigenschappen query Klanten</figcaption><p></p>
</figure>
</div>
<p>Wanneer je met SQL werkt, dan is de opdracht:</p>
<pre><code>SELECT Klanten.Bedrijf
FROM Klanten
INNER JOIN Orders ON Klanten.Klantnr = Orders.Klantnr;</code></pre>
<p><strong>RESULTAAT</strong></p>
<div id="fig-qry-standaard-resultaat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-standaard-resultaat.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;4: Vier rijen, voor elke klantorder is er een rij, alle records worden getoond.</figcaption><p></p>
</figure>
</div>
</section>
<section id="qry-klanten-unieke-waarden" class="level1">
<h1>qry Klanten unieke waarden</h1>
<p><strong>Ontwerp</strong></p>
<p>In het Eigenschappenvenster wordt <code>Unieke waarden = Ja</code>.</p>
<div id="fig-qry-uniekewaarden-ontwerp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-uniekewaarden-ontwerp.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;5: Ontwerp qry Klanten unieke waarden.</figcaption><p></p>
</figure>
</div>
<p>Wanneer je met SQL werkt, dan is de opdracht:</p>
<pre><code>SELECT DISTINCT Klanten.Bedrijf
FROM Klanten
INNER JOIN Orders ON Klanten.Klantnr = Orders.Klantnr;</code></pre>
<p><strong>Resultaat</strong></p>
<div id="fig-qry-uniekewaarden-resultaat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-uniekewaarden-resultaat.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;6: Twee unieke rijen, de resultaten worden beperkt tot unieke waarden in het uitvoerveld.</figcaption><p></p>
</figure>
</div>
</section>
<section id="qry-klanten-unieke-records" class="level1">
<h1>qry Klanten unieke records</h1>
<p><strong>Ontwerp</strong></p>
<p>In het Eigenschappenvenster wordt <code>Unieke records = Ja</code>.</p>
<div id="fig-qry-uniekerecords-ontwerp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-uniekerecords-ontwerp.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;7: Ontwerp qry Klanten unieke records.</figcaption><p></p>
</figure>
</div>
<p>Wanneer je met SQL werkt, dan is de opdracht:</p>
<pre><code>SELECT DISTINCTROW Klanten.Bedrijf
FROM Klanten
INNER JOIN Orders ON Klanten.Klantnr = Orders.Klantnr;</code></pre>
<p><strong>Resultaat</strong></p>
<div id="fig-qry-uniekerecords-resultaat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="qry-uniekerecords-resultaat.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figuur&nbsp;8: Drie rijen, want de resultaten in alle onderliggende tabellen moeten uniek zijn, dus niet de uitvoervelden.</figcaption><p></p>
</figure>
</div>
<p>Je ziet hier twee keer “Jansen BV”. Weliswaar is dat niet uniek in het uitvoerveld, maar ze zijn uniek omdat de ene in Amsterdam zit en de andere in Londen.</p>
<p>Wanneer je zelf met deze datase wilt werken dan kun je deze hier downloaden: <a href="Voorbeeld_Uniek.accdb">Database Voorbeeld_Uniek</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/bwelman\.github\.io\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 copyright 2022, Ben Welman
  </li>  
</ul>
    </div>   
  </div>
</footer>



</body></html>