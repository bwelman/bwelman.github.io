<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Welman">

<title>Ben Welman - Aselecte getallen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden",
    "search-label": "Zoeken"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DZG4072LJ3"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DZG4072LJ3', { 'anonymize_ip': true});
</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo-transparant.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Zoeken"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Schakel tussen navigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../studieboeken.html" rel="" target="">
 <span class="menu-text">Studieboeken</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../softwijs.html" rel="" target="">
 <span class="menu-text">Softwijs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../vlearmoesbier.html" rel="" target="">
 <span class="menu-text">Vlearmoesbier</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Op deze pagina</h2>
   
  <ul>
  <li><a href="#aselect-functies" id="toc-aselect-functies" class="nav-link active" data-scroll-target="#aselect-functies">ASELECT Functies</a></li>
  <li><a href="#analysis-toolpak-gegevensanalyse" id="toc-analysis-toolpak-gegevensanalyse" class="nav-link" data-scroll-target="#analysis-toolpak-gegevensanalyse">Analysis Toolpak (Gegevensanalyse)</a></li>
  
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/bwelman/bwelman.github.io/issues/new" class="toc-action">Een probleem melden</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Aselecte getallen</h1>
  <div class="quarto-categories">
    <div class="quarto-category">excel</div>
    <div class="quarto-category">statistiek</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur</div>
    <div class="quarto-title-meta-contents">
             <p>Ben Welman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Publicatiedatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">17 mei 2020</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Samenvatting</div>
    <p>Over hoe willekeurige getallen kunt genereren in Excel.</p>
  </div>
</div>

</header>

<p>Voor onderwijskundige doeleinden is het soms nodig om zelf data te genereren omdat je bijvoorbeeld een specifiek patroon in de data wilt behandelen en daar geen goede data voor hebt.</p>
<p>Aselecte getallen, ook wel willekeurige getallen of toevalsgetallen genoemd, worden gemaakt met een zogenaamde <em>toevalsgenerator (random generator)</em>. Deze trekt willeurig (aselect) een getal uit een verzameling getallen. Zo haalt de ballenmachine bij Lotto een willekeurig getaL uit de verzameling getallen 1 t/m 45. Computerprogramma’s gebruiken meestal een algoritme waarin via wiskundige formules een getal geproduceerd wordt. Excel maakt net als veel andere programma’s gebruikt van het zogenaamde Mersenne Twister algoritme. Dit zijn in werkelijkheid geen echte willekeurige getallen, maar pseudo-willekeurige getallen omdat ze op een voorspelbare manier geproduceerd zijn. Voor de meeste doeleinden is dit geen probleem.</p>
<p>Bij het genereren van een getal wordt altijd aangeven binnen welke grenzen (ondergrens, bovengrens) het getal moet liggen. Dit interval wordt aangeduid met een combinatie van ronde haken <code>()</code> en blokhaken <code>[]</code>. Een ronde haak betekent dat de grenswaarde niet tot de klasse behoort. Een blokhaak betekent dat de grenswaarde wel tot de klasse behoort. Zo hoort bij het interval <code>[25,40)</code> de waarde 25 er wel bij en de waarde 40 niet.</p>
<p>In Excel kun je aselecte getallen te genereren met functies en met de analysis toolpak.</p>
<section id="aselect-functies" class="level2">
<h2 class="anchored" data-anchor-id="aselect-functies">ASELECT Functies</h2>
<p>Excel heeft drie functies voor het genereren van aselecte getallen. Een mogelijk nadeel van het gebruik van functies is dat deze iedere keer opnieuw worden uitgevoerd wanneer je een wijziging in een werkblad aanbrengt en ook wanneer je het bestand opent. Je krijgt dan steeds nieuwe getallen. Dat is niet in alle situaties handig. Wat je kunt doen is deze getallen na het genereren te kopieren en daarna te plakken als waarden.</p>
<p><strong>ASELECT()</strong>, in het Engels <strong>RAND()</strong></p>
<p>Syntax: <code>ASELECT()</code> , de functie heeft geen argumenten</p>
<p>Deze produceert een getal groter of gelijk aan 0 en kleiner dan 1. Dus een decimaal getal in het interval <code>[0,1)</code>. Om meerdere willekeurige getallen te krijgen plaats je deze formule in een cel en kopieer vervolgens de formule naar andere cellen. En om willekeurige decimale getallen tussen andere grenswaarden te krijgen, in het interval <code>[ondergrens,bovengrens)</code> wijzig je de formule in</p>
<p><code>=ondergrens + ASELECT()*(bovengrens-ondergrens)</code></p>
<p>In de volgende afbeelding zie je hoe willekeurige getallen in het interval <code>[10,50)</code> zijn gegenereerd.</p>
<div id="fig-aselect" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselect.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;1: Willekeurige getallen in het interval <code>[10,50)</code> met functie ASELECT</figcaption>
</figure>
</div>
<p>Wanneer je gehele getallen wilt moet je voorgaande formule binnnen de functie <code>INTEGER()</code> plaatsen, die een getal naar beneden afrondt op het dichtstbijzijnde gehele getal.</p>
<p><strong>ASELECTTUSSEN()</strong>, in het Engels <strong>RANDBETWEEN()</strong></p>
<p>Syntax: <code>ASELECTTUSSEN(laagst;hoogst)</code></p>
<ul>
<li><em>laagst</em>, het kleinste gehele getal dat geretourneerd kan worden.</li>
<li><em>hoogst</em>, het grootste gehele getal dat geretourneerd kan worden</li>
</ul>
<p>Deze functie produceert een willekeurig geheel getal uit het interval <code>[laagst,hoogst]</code>. In tegenstelling tot <em>ASELECT()</em> doen hier beide grenswaarden mee.</p>
<div id="fig-aselecttussen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselecttussen.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;2: Willekeurige getallen uit het interval 10 t/m 50 met functie ASELECTTUSSEN</figcaption>
</figure>
</div>
<p>Met wat trucs kun je ook andere getallen dan gehele getallen genereren. Zo zou je voor prijzen van artikelen die tussen €10,00 en €90,00 liggen gebruik kunnen maken van de formule in de volgende afbeelding:</p>
<div id="fig-aselecttussen-euro" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselecttussen-euro.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;3: Willekeurige getallen uit het interval 10,00 t/m 90,00</figcaption>
</figure>
</div>
<p>Om twee decimalen te krijgen worden de grenswaarden 10 en 90 eerst met 100 vermenigvuldigd. Dan wordt er een getal gegenereerd uit het interval <code>[1000, 9000]</code> waarna dit getal door 100 gedeeld wordt en je precies twee decimalen krijgt. De cellen kun je vooraf of achteraf opmaken als geldbedragen.</p>
<p>En door creatief gebruik te maken van afrondfuncties zijn er verrassende mogelijkheden. Het volgende voorbeeld genereert 5-vouden uit het interval <code>[0, 100]</code>.</p>
<div id="fig-aselecttussen-5voud" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselecttussen-5voud.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;4: Willekeurige vijfvouden</figcaption>
</figure>
</div>
<p>Ook het genereren van datums (alsmede tijdstippen) is hiermee mogelijk, omdat intern in Excel een datum en tijd als een getal wordt opgeslagen. Zo staat het getal 1 voor “1-1-1900 00:00:00”. In het volgende voorbeeld worden willekeurige datums uit het jaar 2019 gegenereerd. Ook hier moet je de cellen waarin het resultaat komt, opmaken in het gewenste datumformaat.</p>
<div id="fig-aselecttussen-datums" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselecttussen-datums.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;5: Willekeurige datums in 2019</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opmerking
</div>
</div>
<div class="callout-body-container callout-body">
<p>In plaats van de functie <code>DATUM()</code> kun je hier ook de functie <code>DATUMWAARDE()</code> gebruiken. De formule wordt dan</p>
<p><code>=ASELECTTUSSEN(DATUMWAARDE("1-1-2019");DATUMWAARDE("31-12-2019"))</code></p>
</div>
</div>
<p><strong>ASELECT.MATRIX()</strong>, in het Engels <strong>RANDARRAY()</strong></p>
<p>Syntax: <code>ASELECT.MATRIX(rijen;kolommen;min;max;geheel)</code></p>
<ul>
<li><em>rijen</em>, het aantal rijen met getallen dat geretourneerd moet worden (optioneel)</li>
<li><em>kolommen</em>, het aantal kolommen met getallen dat geretourneerd moet worden (optioneel)</li>
<li><em>min</em>, de minimale waarde die geretourneerd kan worden (optioneel)</li>
<li><em>max</em>, de maximale waarde die geretourneerd kan worden (optioneel)</li>
<li><em>geheel</em>, WAAR voor gehele getallen, ONWAAR voor decimale getallen (optioneel)</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opmerking
</div>
</div>
<div class="callout-body-container callout-body">
<p>Deze functie is op het moment van schrijven alleen in Excel 365 beschikbaar voor Microsoft subscribers</p>
</div>
</div>
<p>De functie produceert een <em>matrix (array)</em> met willekeurige getallen. Zonder argumenten wordt er één getal tussen 0 en 1 geretourneerd. Wanneer de minimum- en maximumwaarde worden weggelaten, worden er getallen tussen 0 en 1 geretourneerd.</p>
<p>Als voorbeeld weer het genereren van gehele getallen tussen 10 en 50. De formule is <code>=ASELECT.MATRIX(3;4;10;50;WAAR)</code>.</p>
<p>In tegenstelling tot de vorige functies selecteer je hier maar één cel waar je de formule invoert. Het resultaat is een array, een nieuwe gegevensstructuur in Excel. De waarden van de array komen niet alleen in de geselecteerde cel, maar <em>lopen over</em> naar de naburige cellen. Excel maakt dynamisch de benodigde ruimte voor de array wanneer de formule ingevoerd wordt. Wanneer een van die benodigde cellen bezet is krijg je een foutmelding.</p>
<div id="fig-aselectmatrix" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselectmatrix.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;6: Een array van 3 rijen en 4 kolommen met willekeurige getallen van 10 t/m 50</figcaption>
</figure>
</div>
<p>Dit ziet er bij de eerste aanblik hetzelfde uit als bij <code>ASELECTTUSSEN()</code>, maar er zijn verschillen omdat het een array is. Allereerst zie je een lichtblauw kader om de array. En wanneer je een andere cel selecteert dan die waar de formule is ingevoerd, zie je in de formulebalk dat de formule grijs geworden is. Ook kun je in de andere cellen geen wijzigingen aanbrengen.</p>
<p>Meer informatie over dynamische arrays komt in afzonderlijke artikelen.</p>
</section>
<section id="analysis-toolpak-gegevensanalyse" class="level2">
<h2 class="anchored" data-anchor-id="analysis-toolpak-gegevensanalyse">Analysis Toolpak (Gegevensanalyse)</h2>
<p>In de Analysis Toolpak zit ook een keuze om willekeurige getallen te genereren. Het gebruik hiervan is wat flexibeler dan het werken met de hiervoor genoemde functies. De werkwijze is als volgt. Kies</p>
<p><em>tabblad Gegevens -&gt; Gegevensanalyse (groep Analyse) -&gt; Aselecte getallen</em></p>
<p>Het dialoogscherm dat je krijgt kan wat van het volgende afwijken, maar ziet er grotendeels hetzelfde uit.</p>
<div id="fig-atp-discreet" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="atp-discreet.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;7: Dialoogscherm Aselecte getallen</figcaption>
</figure>
</div>
<ul>
<li><p><em>Aantal variabelen</em>: het aantal kolommen in het uitvoergebied dat je met waarden wilt vullen.</p></li>
<li><p><em>Aantal aselecte getallen</em>: het aantal rijen in het uitvoergebied dat je met waarden wilt vullen.</p></li>
</ul>
<p>Je kunt deze twee invulvakken ook leeg laten.In dat geval wordt het verderop gespecificeerde uitvoergebied met waarden gevuld.</p>
<ul>
<li><em>Verdelingstype</em>: keuzemogelijkheden Uniforme verdeling, Normale verdeling, Bernouilli verdeling, Binomiale verdeling, Poisson verdeling, Patroonmatige verdeling, Discrete verdeling.</li>
</ul>
<p>Voor het genereren van willekeurige getallen tussen twee grenzen kies je voor Uniforme verdeling. Afhankelijk van de gekozen verdeling wijzigt het scherm zodat je de parameters voor de gekozen verdeling kunt invullen. Bij een Uniforme verdeling zijn dat de twee grenswaarden, aangegeven met Tussen … en …</p>
<ul>
<li><p><em>Aselecte waarde maken</em>: Hier kun je desgewenst een startpunt (de zogenaamde seed) voor de random generator opgeven, waardoor je een volgende keer dezelfde willekeurige getallen kunt produceren. In het algemeen kun je dit beter leeg laten.</p></li>
<li><p><em>Uitvoeropties</em>: Gebruik de selectieknoppen om de locatie voor de willekeurige getallen aan te geven.</p></li>
</ul>
<p>Als voorbeeld worden weer getallen gegenereerd tussen 10 en 50.</p>
<div id="fig-aselect-toolpak-uniform" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselect-toolpak-uniform.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;8: Invulling dialoogscherm voor het genereren van willekeurige getallen tussen 10 en 50</figcaption>
</figure>
</div>
<p>Het resultaat ziet er ongeveer uit als volgt:</p>
<div id="fig-aselect-toolpak-result" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="aselect-toolpak-result.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;9: Resultaat gegevensanalyse</figcaption>
</figure>
</div>
<p>Er staat geen formule in een van de cellen. De getallen veranderen dan ook niet wanneer er een wijziging in het werkblad komt.</p>
<p>Er worden altijd decimale getallen geproduceerd. Wil je gehele getallen hebben, dan zul je deze daarna nog met een functie moeten omzetten naar gehele getallen.</p>
</section>


<div id="quarto-appendix" class="default"><section id="lees-verder" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Lees verder</h2><div class="quarto-appendix-contents">

<ul>
<li><a href="https://support.office.com/nl-nl/article/aselect-functie-4cbfa695-8869-4788-8d90-021ea9f5be73?ui=nl-NL&amp;rs=nl-NL&amp;ad=NL">Microsoft support</a>, support voor ASELECT functie waarin tevens de naam van het algoritme genoemd wordt.</li>
<li><a href="https://en.wikipedia.org/wiki/Mersenne_Twister">Mersenne Twister algoritme (Wikipedia)</a></li>
<li><a href="https://www.random.org/">Random.org</a>, website met artikelen over toevalsgetallen en een aantal gratis online random generators voor echte toevalsgetallen door gebruik te maken van astronomische ruis.</li>
</ul>


</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/bwelman\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 copyright 2022, Ben Welman
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>