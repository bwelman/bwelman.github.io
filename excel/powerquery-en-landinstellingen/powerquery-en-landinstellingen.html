<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl" xml:lang="nl"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Archief Ben - Powerquery en Landinstellingen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Geen resultaten",
    "search-matching-documents-text": "Gevonden documenten",
    "search-copy-link-title": "Kopieer link om te zoeken",
    "search-hide-matches-text": "Extra overeenkomsten verbergen",
    "search-more-match-text": "meer overeenkomst in dit document",
    "search-more-matches-text": "meer overeenkomsten in dit document",
    "search-clear-button-title": "Wissen",
    "search-detached-cancel-button-title": "Annuleren",
    "search-submit-button-title": "Verzenden",
    "search-label": "Zoeken"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-DZG4072LJ3"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DZG4072LJ3', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo-transparant.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Archief Ben</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Zoeken"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Schakel tussen navigatie" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../access.html" rel="" target="">
 <span class="menu-text">Access</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../excel.html" rel="" target="">
 <span class="menu-text">Excel</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../bier.html" rel="" target="">
 <span class="menu-text">Bier</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../chemie.html" rel="" target="">
 <span class="menu-text">Chemie</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../divers.html" rel="" target="">
 <span class="menu-text">Divers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html" rel="" target="">
 <span class="menu-text">Tutorials</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Op deze pagina</h2>
   
  <ul>
  <li><a href="#instellingen-besturingssysteem" id="toc-instellingen-besturingssysteem" class="nav-link active" data-scroll-target="#instellingen-besturingssysteem">Instellingen besturingssysteem</a></li>
  <li><a href="#query-opties" id="toc-query-opties" class="nav-link" data-scroll-target="#query-opties">Query Opties</a></li>
  <li><a href="#gegevenstype-wijzigen" id="toc-gegevenstype-wijzigen" class="nav-link" data-scroll-target="#gegevenstype-wijzigen">Gegevenstype wijzigen</a></li>
  <li><a href="#samenvatting" id="toc-samenvatting" class="nav-link" data-scroll-target="#samenvatting">Samenvatting</a></li>
  <li><a href="#experimenteren" id="toc-experimenteren" class="nav-link" data-scroll-target="#experimenteren">Experimenteren</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Powerquery en Landinstellingen</h1>
  <div class="quarto-categories">
    <div class="quarto-category">powerquery</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Publicatiedatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">14 maart 2022</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Samenvatting</div>
    <p>Het gebruik van landinstellingen bij het importeren van platte bestanden (.csv).</p>
  </div>
</div>

</header>

<p>Veel gegevensbestanden zijn platte bestanden ( .txt, .csv, …). Dit soort bestanden heeft geen metalaag of schema waarin beschreven staat hoe de gegevens geïnterpreteerd moeten worden. Wanneer deze gegevens in Excel geïmporteerd worden doet Power Query wel een poging hiertoe. Dat gaat vaak goed, maar vooral bij numerieke- en datumgegevens uit Engelstalige bronnen gaat het vaak fout.</p>
<ul>
<li><em>Numerieke gegevens</em>: Engelstalige landen gebruiken een punt als decimaalteken en een komma als scheidingdteken voor duizendtallen. In Nederland (en veel andere Europese landen) is dit precies andersom, een komma als decimaal teken en een punt voor de duizendtallen.</li>
<li><em>Datums</em>: In de VS is de opmaak meestal mm/dd/jjjj en in Europa dd/mm/jjjj.</li>
</ul>
<p>Het is aan te raden om altijd zo’n plat bestand eerst met een programma als kladblok of Notepad te bekijken om dit vast te stellen.</p>
<section id="instellingen-besturingssysteem" class="level2">
<h2 class="anchored" data-anchor-id="instellingen-besturingssysteem">Instellingen besturingssysteem</h2>
<p>Wanneer je met een nieuw Excelbestand begint en hierin via Power Query gegevens uit een plat bestand importeert, dan wordt door Power Query de locale versie van het besturingssysteem gebruikt als standaardinstelling. Met deze instelling wordt bepaald hoe Power Query de gegevens interpreteert.Je kunt in Windows deze instellingen vinden en wijzigen via <strong>Configuratiescherm &gt; Tijd en taal &gt; Land/regio</strong>.</p>
<p>De gebruikte landinstelling wordt in de query bewaard. Wanneer het Excelbestand later door een andere gebruiker met een andere landinstelling wordt gebruikt, dan gebruikt Power Query de landinstelling die in de query is opgeslagen, waardoor de query goed blijft werken.</p>
</section>
<section id="query-opties" class="level2">
<h2 class="anchored" data-anchor-id="query-opties">Query Opties</h2>
<p>Via de Queryopties van Power Query kun je ook de te gebruiken landinstellingen specificeren. Vanuit een Excel werkblad kies je <strong>tab Gegevens &gt; Gegevens ophalen &gt; Query opties</strong>.</p>
<div id="fig-query-opties-werkmap" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="query-opties-werkmap.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;1: Regionale instellingen huidige werkmap</figcaption>
</figure>
</div>
<p>Kies <strong>Regionale instellingen</strong> onder <strong>Huidige werkmap</strong>. Bij een nieuwe werkmap staat bij landinstellingen de standaardinstelling van het besturingssysteem. Je kunt hier een andere instelling opgeven en deze wordt met de query bewaard. De hier gespecificeerde landinstellingen worden alleen bij de query’s gebruikt en niet op andere plekken in Excel.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
LET OP
</div>
</div>
<div class="callout-body-container callout-body">
<p>Onder GLOBAAL zit ook een Regionale instellingen. Hiermee kun je alleen de taal instellen voor de automatisch gegenereerde stapnamen.</p>
</div>
</div>
<p>Wanneer je na een import ziet dat het fout gegaan is met de landinstellingen, dan kun je ook achteraf via de Queryopties de landinstellingen wijzigen. Daarna moet je de query opnieuw uitvoeren. De import zou dan goed moeten verlopen.</p>
</section>
<section id="gegevenstype-wijzigen" class="level2">
<h2 class="anchored" data-anchor-id="gegevenstype-wijzigen">Gegevenstype wijzigen</h2>
<p>Tot slot kun je ook nog in de Power Query Editor de landinstellingen voor een of meerdere kolommen wijzigen. Deze route is handig wanneer je met verschillende landinstellingen voor meerdere query’s binnen dezelfde werkmap moet werken. Is goed bruikbaar wanneer je voor enkele kolommen de landinstellingen wilt wijzigen en voor de andere kolommen met de standaardinstelling wilt werken.</p>
<p>In de in Power Query Editor geopende query klik je met de rechtermuisknop op een kolomkop en kies je vervolgens <strong>Type wijzigen &gt; Op basis van landinstellingen-id</strong>.</p>
<div id="fig-gegevenstype-wijzigen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gegevenstype-wijzigen.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;2: Menukeuzes voor het wijzigen van het gegevenstype op basis van de landinstellingen.</figcaption>
</figure>
</div>
<p>In het dan verschijnende dialoogvenster selecteer je de gewenste landinstellingen.</p>
<div id="fig-gegevenstype-landinstellingen" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="gegevenstype-landinstellingen.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figuur&nbsp;3: Dialoogscherm landinstellingen voor gegevenstype.</figcaption>
</figure>
</div>
</section>
<section id="samenvatting" class="level2">
<h2 class="anchored" data-anchor-id="samenvatting">Samenvatting</h2>
<ol type="1">
<li><p>De landinstellingen voor het besturingssysteem wijzigen is aan te bevelen wanneer je meestal de bestanden uit een specifiek land importeert en je ook wilt dat ze in de opmaak van dat land in het Excel werkblad verschijnen. Deze landinstellingen gelden voor alle programma’s op jouw computer.</p></li>
<li><p>De landinstellingen wijzigen via Queryopties is in de meeste gevallen de aan te bevelen methode. Deze landinstellingen gelden voor alle query’s in de werkmap.</p></li>
<li><p>De landinstellingen wijzigen via gegevenstype in de Query Editor gebruik je wanneer je met meerdere landinstellingen in een of meerdere query’s in dezelfde werkmap werkt. De landinstellingen gelden alleen voor de geselecteerde kolom in de query.</p></li>
</ol>
</section>
<section id="experimenteren" class="level2">
<h2 class="anchored" data-anchor-id="experimenteren">Experimenteren</h2>
<p>Ik heb twee kleine gegevensbestanden gemaakt om mee te experimenteren. Deze bevatten dezelfde gegevens, maar verschillen in opmaak voor de variabelen <code>datum</code> en <code>prijs</code> en in het lijstscheidingsteken.</p>
<ul>
<li><a href="brandstofprijzen-nl.csv">brandstofprijzen-nl.csv</a> - Opmaak Nederland.</li>
<li><a href="brandstofprijzen-en.csv">brandstofprijzen-en.csv</a> - Opmaak Verenigde Staten.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Gekopieerd!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Gekopieerd!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/bwelman\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Deze website is gemaakt met <a href="https://quarto.org/">Quarto</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>